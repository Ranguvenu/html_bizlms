define ("block_trending_modules/trending_modules",["jquery","core/ajax","core/templates","core/fragment","core/str","core/modal_factory","core/modal_events","local_costcenter/cardPaginate"],function(a,b,c,d,e,f,g,h){return trending_module={init:function init(){a(document).on("keyup","#filter_trending_modules",function(){var d=a(this).val(),e=a(this).data(),f=e.target,g=e.navigator,h=JSON.stringify(e);setTimeout(function(){var e=b.call([{methodname:"block_trending_modules_display_content",args:{indexid:0,contextid:1,search:d,jsondata:h}}]);e[0].done(function(b){var d={records:b.records};c.render("block_trending_modules/trending_module",d).then(function(c){a(f).html(c);a(g).data("totalcount",b.totalcount)})})},200)});a(document).on("click",".block_trending_modules_navigator",function(){var d=a(this).data();if("right"==d.action){var e=d.offset+3}else if("left"==d.action){var e=d.offset-3}else{return}a(".block_trending_modules_navigator").data("offset",e);if(e+d.limit>=d.totalcount){a(".block_trending_modules_navigator.right_navigator").addClass("hidden")}else if(3<d.totalcount){a(".block_trending_modules_navigator.right_navigator").removeClass("hidden")}if(0==e){a(".block_trending_modules_navigator.left_navigator").addClass("hidden")}else{a(".block_trending_modules_navigator.left_navigator").removeClass("hidden")}var f={indexid:e,limitnum:3,contextid:1,search:""},g=b.call([{methodname:"block_trending_modules_display_content",args:f}]);g[0].done(function(b){var d={records:b.records};c.render("block_trending_modules/trending_module",d).then(function(b){a("#trending_modules_content").html(b)})})});a(document).on("click",".block_suggested_modules_navigator",function(){var d=a(this).data(),e=JSON.stringify(d);if("right"==d.action){var f=d.offset+3}else if("left"==d.action){var f=d.offset-3}else{return}a(".block_suggested_modules_navigator").data("offset",f);if(f+d.limit>=d.totalcount){a(".block_suggested_modules_navigator.right_navigator").addClass("hidden")}else if(3<d.totalcount){a(".block_suggested_modules_navigator.right_navigator").removeClass("hidden")}if(0==f){a(".block_suggested_modules_navigator.left_navigator").addClass("hidden")}else{a(".block_suggested_modules_navigator.left_navigator").removeClass("hidden")}var g={indexid:f,limitnum:3,contextid:1,search:"",jsondata:e},h=b.call([{methodname:"block_trending_modules_display_content",args:g}]);h[0].done(function(b){var d={records:b.records};c.render("block_trending_modules/trending_module",d).then(function(b){a("#suggested_modules_content").html(b)})})})},display_popup:function display_popup(){d.loadFragment("block_trending_modules","get_trending_popup",1,{}).done(function(c){return e.get_string("pluginname","block_trending_modules").then(function(d){f.create({title:d,type:f.types.DEFAULT,body:c}).done(function(c){this.modal=c;this.modal.setLarge();this.modal.getRoot().addClass("trending_modal_popup");this.modal.getRoot().on(g.hidden,function(){var c=a(".update_trending_preference").is(":checked");if(c){params={};params.contextid=1;params.status=!c;var d=b.call([{methodname:"block_trending_modules_alter_popup_status",args:params}]);d[0].done(function(){a(".update_trending_preference").prop("checked",!0)}).fail(function(a){console.log(a)})}});c.show()}.bind(this))}.bind(this))})},update_preference:function update_preference(){a(document).on("click",".update_trending_preference",function(){var c=a(this).prop("checked");params={};params.contextid=1;params.status=!c;var d=b.call([{methodname:"block_trending_modules_alter_popup_status",args:params}]);d[0].done(function(){}).fail(function(a){console.log(a)})})},load:function load(){var b={targetID:"show_suggested_modules_content",perPage:3,cardClass:"col-md-4 col-4",viewType:"card",methodName:"block_trending_modules_display_paginated",templateName:"block_trending_modules/trending_module_paginated"},c={};a(document).on("click",".show_suggested_modules",function(){var d=a(this).data(),i="<label>Search : </label><input type=\"text\" name=\"search\" id=\"search_popup_content\" data-module_type="+d.moduletype+" data-module_tags="+d.tags+"><div class=\"d-inline-blocks card-paginate_wrap\" id=\""+"show_suggested_modules_content"+"\" data-region=\""+"show_suggested_modules_content"+"-preview-container\"><div data-region=\""+"show_suggested_modules_content"+"-count-container\"></div><div data-region=\""+"show_suggested_modules_content"+"-list-container\" id =\""+"show_suggested_modules_content"+"id\"></div></div>",j={module_type:d.moduletype,module_tags:d.tags,show_suggestions:d.show_suggestions};e.get_string("suggested_modules","block_trending_modules").then(function(a){f.create({title:a,type:f.types.DEFAULT,body:i}).done(function(a){this.modal=a;this.modal.setLarge();a.show();this.modal.getRoot().addClass("suggested_modules");h.reload(b,c,j);this.modal.getRoot().on(g.hidden,function(){a.destroy()})}.bind(this))}.bind(this))});var d;a(document).on("keyup","#search_popup_content",function(){clearTimeout(d);var e=a(this).val(),f=a(this).data();d=setTimeout(function(){var a={module_type:f.module_type,module_tags:f.module_tags,show_suggestions:f.show_suggestions,search_query:e};h.reload(b,c,a)},100)});a(document).on("keydown","#search_popup_content",function(){clearTimeout(d)})}}});
//# sourceMappingURL=trending_modules.min.js.map
