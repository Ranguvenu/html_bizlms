{"version":3,"sources":["../src/trending_modules.js"],"names":["define","$","Ajax","Templates","Fragment","Str","ModalFactory","ModalEvents","cardPaginate","trending_module","init","document","on","searchvalue","val","data","target","navigatorElm","navigator","jsondata","JSON","stringify","setTimeout","promise","call","methodname","args","indexid","contextid","search","done","resp","records","render","then","html","totalcount","action","new_offset","offset","limit","addClass","removeClass","params","limitnum","display_popup","loadFragment","get_string","s","create","title","type","types","DEFAULT","body","modal","setLarge","getRoot","hidden","statuschange","is","status","prop","fail","ex","console","log","show","bind","update_preference","load","options","targetID","perPage","cardClass","viewType","methodName","templateName","dataoptions","contenthtml","moduletype","tags","filterdata","module_type","module_tags","show_suggestions","header","reload","destroy","timer","clearTimeout","search_query"],"mappings":"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","sourcesContent":["/**\n *\n * @module     block_trending_modules/trending_modules\n * @class      trending_modules\n * @package    block_trending_modules\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/ajax', 'core/templates', 'core/fragment', 'core/str', 'core/modal_factory', 'core/modal_events', 'local_costcenter/cardPaginate'], \n        function ($, Ajax, Templates, Fragment, Str, ModalFactory, ModalEvents, cardPaginate){\n\treturn trending_module = {\n\t\tinit: function(){\n\t\t\tvar search_interval = 200;\n        \t$(document).on('keyup', '#filter_trending_modules', function(){\n        \t\tvar searchvalue = $(this).val();\n                var data = $(this).data();\n                var target = data.target;\n                var navigatorElm = data.navigator; \n                var jsondata = JSON.stringify(data);\n            \tsetTimeout(function(){\n            \t\tvar params = {};\n            \t\tparams.indexid = 0;\n        \t\t\tparams.contextid = 1;\n            \t\tparams.search = searchvalue;\n            \t\tparams.jsondata = jsondata;\n\n            \t\tvar promise = Ajax.call([{\n                        methodname: 'block_trending_modules_display_content',\n                        args: params\n                    }]);\n                    promise[0].done(function(resp) {\n                    \tvar data = {};\n                    \tdata.records = resp.records; \n                    \tTemplates.render('block_trending_modules/trending_module', data).then(function(html,js) {\n                    \t\t$(target).html(html);\n                            $(navigatorElm).data('totalcount', resp.totalcount);\n                    \t});\n                    });\n            \t}, search_interval);\n\t\t\t});\n            $(document).on('click', '.block_trending_modules_navigator', function(){\n                var data = $(this).data();\n                if(data.action == 'right'){\n                    var new_offset = data.offset + 3;\n                }else if(data.action == 'left'){\n                    var new_offset = data.offset - 3;\n                }else{\n                    return;\n                }\n                $('.block_trending_modules_navigator').data('offset', new_offset);\n                // $('.block_trending_modules_navigator').attr('data-offset', new_offset);\n                if(new_offset+data.limit >= data.totalcount){\n                    $('.block_trending_modules_navigator.right_navigator').addClass('hidden');\n                }else if(data.totalcount > 3){\n                    $('.block_trending_modules_navigator.right_navigator').removeClass('hidden');\n                }\n                if(new_offset == 0){\n                    $('.block_trending_modules_navigator.left_navigator').addClass('hidden');\n                }else{\n                    $('.block_trending_modules_navigator.left_navigator').removeClass('hidden');\n                }\n\n                var params = {};\n                params.indexid = new_offset;\n                params.limitnum = 3;\n                params.contextid = 1;\n                params.search = '';\n                \n                var promise = Ajax.call([{\n                    methodname: 'block_trending_modules_display_content',\n                    args: params\n                }]);\n                promise[0].done(function(resp) {\n                    // console.log(resp);\n                    var data = {};\n                    data.records = resp.records; \n                    Templates.render('block_trending_modules/trending_module', data).then(function(html,js) {\n                        $('#trending_modules_content').html(html);\n                    });\n                });\n            });\n            $(document).on('click', '.block_suggested_modules_navigator', function(){\n                var data = $(this).data();\n                var jsondata = JSON.stringify(data);\n                if(data.action == 'right'){\n                    var new_offset = data.offset + 3;\n                }else if(data.action == 'left'){\n                    var new_offset = data.offset - 3;\n                }else{\n                    return;\n                }\n                $('.block_suggested_modules_navigator').data('offset', new_offset);\n                // $('.block_trending_modules_navigator').attr('data-offset', new_offset);\n                if(new_offset+data.limit >= data.totalcount){\n                    $('.block_suggested_modules_navigator.right_navigator').addClass('hidden');\n                }else if(data.totalcount > 3){\n                    $('.block_suggested_modules_navigator.right_navigator').removeClass('hidden');\n                }\n                if(new_offset == 0){\n                    $('.block_suggested_modules_navigator.left_navigator').addClass('hidden');\n                }else{\n                    $('.block_suggested_modules_navigator.left_navigator').removeClass('hidden');\n                }\n\n                var params = {};\n                params.indexid = new_offset;\n                params.limitnum = 3;\n                params.contextid = 1;\n                params.search = '';\n                params.jsondata = jsondata;\n                \n                var promise = Ajax.call([{\n                    methodname: 'block_trending_modules_display_content',\n                    args: params\n                }]);\n                promise[0].done(function(resp) {\n                    // console.log(resp);\n                    var data = {};\n                    data.records = resp.records; \n                    Templates.render('block_trending_modules/trending_module', data).then(function(html,js) {\n                        $('#suggested_modules_content').html(html);\n                    });\n                });\n            });\n\t\t\t\n\t\t},\n        display_popup :function(){\n            // var dontshowelement = \"<div class='trending-checkbox w-full d-inline-block text-right'><label class='trend-checkbox-label d-inline-block pull-left mr-1'><input type='checkbox' class = 'update_trending_preference' id = 'force_stop_populating_modules'/><span class='trend-checkbox-custom trend-rectangular'></span></label><div class='pull-left'>Don\\'t show this</div></div>\";\n            Fragment.loadFragment('block_trending_modules', 'get_trending_popup', 1, {}).done(function(html, js){\n                return Str.get_string('pluginname','block_trending_modules').then(function(s) {\n                    ModalFactory.create({\n                        title: s,\n                        type: ModalFactory.types.DEFAULT,\n                        body : html,\n                        // footer : dontshowelement\n                    }).done(function(modal) {\n                        this.modal = modal;\n                        this.modal.setLarge();\n                        this.modal.getRoot().addClass('trending_modal_popup');\n                        this.modal.getRoot().on(ModalEvents.hidden, function() {\n                            var statuschange = $(\".update_trending_preference\").is(':checked');\n                            if(statuschange){\n                                params = {};\n                                params.contextid = 1;\n                                params.status = !statuschange;\n                                var promise = Ajax.call([{\n                                    methodname: 'block_trending_modules_alter_popup_status',\n                                    args: params\n                                }]);\n                                promise[0].done(function(resp) {\n                                    $('.update_trending_preference').prop('checked', true);\n                                }).fail(function(ex) {\n                                     console.log(ex);\n                                });\n                            }\n                        });\n                        // modal.setSaveButtonText(s[3]);\n                        // modal.getRoot().on(ModalEvents.save, function(e) {\n                        //     e.preventDefault();\n                        //     args.confirm = true;\n                        //     var params = {};\n                        //     params.id = args.id;\n                        //     params.contextid = args.contextid;\n                        \n                        //     var promise = Ajax.call([{\n                        //         methodname: 'local_users_suspend_user',\n                        //         args: params\n                        //     }]);\n                        //     promise[0].done(function(resp) {\n                        //         window.location.href = window.location.href;\n                        //     }).fail(function(ex) {\n                        //         // do something with the exception\n                        //          console.log(ex);\n                        //     });\n                        // }.bind(this));\n                        modal.show();\n                    }.bind(this));\n                }.bind(this));\n            });\n        \n        },\n        update_preference : function(){\n            $(document).on('click', '.update_trending_preference', function(){\n                var status = $(this).prop('checked');\n                params = {};\n                params.contextid = 1;\n                params.status = !status;\n                var promise = Ajax.call([{\n                    methodname: 'block_trending_modules_alter_popup_status',\n                    args: params\n                }]);\n                promise[0].done(function(resp) {\n\n                }).fail(function(ex) {\n                    console.log(ex);\n                });\n\n            });\n        },\n        load: function(){\n            var identifier = 'show_suggested_modules_content';\n            var options = {\n                targetID : identifier,\n                perPage : 3,\n                cardClass : 'col-md-4 col-4',\n                viewType : 'card',\n                methodName : 'block_trending_modules_display_paginated',\n                templateName : 'block_trending_modules/trending_module_paginated'\n            };\n            var dataoptions = {};\n            $(document).on('click', '.show_suggested_modules', function(){\n                var data = $(this).data();\n                var contenthtml = '<label>Search : </label><input type=\"text\" name=\"search\" id=\"search_popup_content\" data-module_type='+data.moduletype+' data-module_tags='+data.tags+'><div class=\"d-inline-blocks card-paginate_wrap\" id=\"'+identifier+'\" data-region=\"'+identifier+'-preview-container\"><div data-region=\"'+identifier+'-count-container\"></div><div data-region=\"'+identifier+'-list-container\" id =\"'+identifier+'id\"></div></div>';\n                var filterdata = {\n                    module_type : data.moduletype,\n                    module_tags : data.tags,\n                    show_suggestions : data.show_suggestions\n                };\n\n                Str.get_string('suggested_modules','block_trending_modules').then(function(header) {\n                    ModalFactory.create({\n                        title: header,\n                        type: ModalFactory.types.DEFAULT,\n                        body : contenthtml,\n                    }).done(function(modal) {\n                        this.modal = modal;\n                        this.modal.setLarge();\n                        modal.show();\n                        this.modal.getRoot().addClass('suggested_modules');\n                        cardPaginate.reload(options, dataoptions,filterdata);\n                        this.modal.getRoot().on(ModalEvents.hidden, function() {\n                            modal.destroy();\n                        });\n                    }.bind(this));\n                }.bind(this));\n            });\n            var timer;\n            $(document).on('keyup', '#search_popup_content', function(){\n                clearTimeout(timer);\n                var search = $(this).val();\n                var data = $(this).data();\n                timer = setTimeout(function(){\n                    var filterdata = {\n                        module_type : data.module_type,\n                        module_tags : data.module_tags,\n                        show_suggestions : data.show_suggestions,\n                        search_query : search\n                    };\n                    cardPaginate.reload(options, dataoptions, filterdata);\n                }, 100);\n            });\n            $(document).on('keydown', '#search_popup_content', function(){\n                clearTimeout(timer);\n            });\n        }         \t\t\n   };\n\n});"],"file":"trending_modules.min.js"}