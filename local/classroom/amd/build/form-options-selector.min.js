/**
 * option selector module.
 *
 * @module     tool_lp/form-option-selector
 * @class      form-option-selector
 * @package    tool_lp
 * @copyright  2015 Frédéric Massart - FMCorz.net
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */ define(["jquery","core/ajax","core/templates"],function(e,t,a){return{processResults:function(t,a){var o=[];return e.each(a,function(e,t){o.push({value:t.id,label:t._label})}),o},transport:function(o,n,s,r){var c;if(contextid=parseInt(e(o).data("contextid"),10),action=e(o).data("action"),formoptions=e(o).data("options"),"classroom_institute_selector"===action)institute_type_selector=e(o).data("institute_type"),institute_type=e("[name='"+institute_type_selector+"']:checked").val(),formoptions.institute_type=institute_type;else if("classroom_costcenter_selector"===action)formoptions.department&&(organizationclass=formoptions.organizationselect,formoptions.parnetid=e("[data-class='"+organizationclass+"']").val());else if("classroom_subdepartment_selector"===action){var l=e("#id_department").val();l&&(formoptions.departments_selected=l)}else"classroom_trainer_selector"===action&&(organizationclass=formoptions.organizationselect,formoptions.parentid=e("[data-class='"+organizationclass+"']").val());formoptions=JSON.stringify(formoptions),(c=t.call([{methodname:"local_classroom_form_option_selector",args:{query:n,context:{contextid:contextid},action:action,options:formoptions}}]))[0].then(function(t){t=e.parseJSON(t);var o=[],n=0;return e.each(t,function(e,t){o.push(a.render("local_classroom/form-option-selector-suggestion",t))}),e.when.apply(e.when,o).then(function(){var a=arguments;e.each(t,function(e,t){t._label=a[n],n++}),s(t)})}).catch(r)}}});
